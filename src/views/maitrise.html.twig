{% extends "squelette.html.twig" %}

{% block content %}
<div class="well">
			<form action="{{path('change_unite')}}" method="post" id="changeUniteForm">
			<b>Changer d'unite : </b>
				<select class="selectpicker" data-live-search="true" name="selectedUnite" onchange="$('#changeUniteForm').submit()">	
					<option selected></option>
					{% for unite in accessible_unite %}
						<option value="{{unite.unite_id}}">{{unite.branche_name}} - {{unite.district_name}} - {{ unite.groupe_name}} </option>	
					{% endfor %}
				</select>
			</form>
</div>
<div class="container-fluid">
	<div class="row-fluid">
		<div class="span3">
			<h3>Gestion de la maitrise</h3>
			<p><b>Province :</b> {{unite.province_name}}</p>
			<p><b>District :</b> {{unite.district_name}}</p>
			<p><b>Groupe :</b> {{unite.groupe_name}}</p>
			<p><b>Branche :</b> {{unite.branche_name}}</p>
		</div>
		<div class="span5 offset1">
			<table class="table table-striped table-condensed">
				<tr>
					<th colspan="5" style="text-align: center">Maitrise requise</th>
				</tr>
				<tr>
					<th></th>
					<th>CEP2</th>
					<th>CEP1</th>
					<th>AC</th>
					<th>Total</th>
				</th>
				<tr class="info">
					<td>Actuel</td>
					<td><INPUT type="text" value="{{requirement.actual.3}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.actual.2}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.actual.1}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.actual.0}}" class="input-mini" readonly="true"></td>
				</tr>
				<tr {% if not requirement.currentReqChecked %} class="error" {% endif %}>
					<td>Année</td>
					<td><INPUT type="text" value="{{requirement.currentReq.3}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.currentReq.2}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.currentReq.1}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.currentReq.0}}" class="input-mini" readonly="true"></td>
				</tr>
				<tr {% if not requirement.shortActReqChecked %} class="error" {% endif %}>
					<td>Camp < 5j </td>
					<td><INPUT type="text" value="{{requirement.shortActReq.3}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.shortActReq.2}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.shortActReq.1}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.shortActReq.0}}" class="input-mini" readonly="true"></td>
				</tr>
				<tr {% if not requirement.longActReqChecked %} class="error" {% endif %}>
					<td>Camp >= 5j</td>
					<td><INPUT type="text" value="{{requirement.longActReq.3}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.longActReq.2}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.longActReq.1}}" class="input-mini" readonly="true"></td>
					<td><INPUT type="text" value="{{requirement.longActReq.0}}" class="input-mini" readonly="true"></td>
				</tr>
			</table>
		</div>
	</div>
	<div class="row-fluid">
		<div class="span9">
			<fieldset>
				<legend>Information de l'unité</legend>
				<form id="modifUniteSizeForm" action="{{path('unite_modif_size')}}" method="post">
					<input type="hidden" value="{{unite.id}}" name="id">
					<b>Nb d'enfants :</b> <input type="text" value="{{unite.size}}" class="input-mini" name="size">
					<b>Nb de sizaine :</b> <input type="text" value="{{unite.nb_sizaine}}" class="input-mini" name="nb_sizaine">
					<br>
					<textarea name="commentaire" style="min-width: 500px; min-height: 150px;">{{unite.commentaire}}</textarea>
					<br>
					<center>
					<a class="btn" onclick="$('#modifUniteSizeForm').submit()" style="vertical-align: top;">
						Enregistrer <i class="icon-save"></i>
					</a>
					</center>
				</form>
			</fieldset>
			<fieldset>
				<legend>Composition de la maitrise</legend>
				<table class="table table-striped table-hover">
					<tr>
						<th colspan="4">
							<form action="{{ path('maitrise_add') }}" method="POST">
								<select class="selectpicker" data-live-search="true" name="selectedChef">	
									<option selected></option>
									{% for chef in list_chef %}
										<option value="{{chef.id}}">{{chef.long_name}}</option>	
									{% endfor %}
								</select>
							</div>
							<div class="input-append">
								<a class="btn" onclick="$(this).closest('form').submit()"><i class="icon-link"></i> Ajouter</a>
								<a class="btn btn-primary" href="#userModal" role="button" data-toggle="modal"><i class="icon-plus"></i> Nouveau chef</a>
							</div>
							</form>
						</th>
						<th>
						</th>
					</tr>
					<tr>
						<th></th>
						<th>Nom</th>
						<th>Formation</th>
						<th>Coordonnée</th>
						<td></th>
					</tr>
					{% for chef in maitrise %}
						<tr id="user{{chef.id}}" onDblClick="initMember('#user{{chef.id}}')">

							<input type="hidden" value="{{chef.id}}" class="id">
							<input type="hidden" value="{{chef.long_name}}" class="long_name">
							<input type="hidden" value="{{chef.firstname}}" class="firstname">
							<input type="hidden" value="{{chef.birthday}}" class="birthday">
							<input type="hidden" value="{{chef.mail}}" class="mail">
							<input type="hidden" value="{{chef.tel}}" class="tel">
							<input type="hidden" value="{{chef.adresse}}" class="adresse">
							<input type="hidden" value="{{chef.city}}" class="city">
							<input type="hidden" value="{{chef.post_code}}" class="cp">
							<input type="hidden" value="{{chef.profil}}" class="profil">
							<input type="hidden" value="{{chef.formation_lvl}}" class="formation">
							<input type="hidden" value="{{chef.commentaire}}" class="commentaire">

							<td>{% if chef.profil == 'Chef' %} <i class="icon-certificate">{% endif %}</td>
							<td>{{ chef.long_name}}</td>
							<td>{{ chef.formation_name }}</td>
							<td>{{chef.adresse}}<br>{{chef.post_code}} {{chef.city}}</td>
							<td>
								<a class="btn" onClick="initMember('#user{{chef.id}}')" title="Editer">
									<i class="icon-edit"></i> 
								</a>
								<a class="btn btn-danger" href="{{ path('maitrise_del', {idUser: chef.id}) }}" title="Détacher">
									<i class="icon-unlink"></i> 
								</a>
							</td>
						</tr>
					{% endfor %}
				</table>
				</fieldset>

		</div>
	</div>
</div>


<div id="userModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="Saisir un chef" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Saisir un chef</h3>
  </div>
  <div class="modal-body">
		  <form class="form-horizontal" action="{{path('maitrise_create')}}" id="newChefForm" method="POST">
			  <div class="control-group">
				<label class="control-label" for="inputName">Nom</label>
				<div class="controls">
				  <input type="text" name="inputName" placeholder="Nom complet">
				  <input type="hidden" name="inputId" value="0">
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputFirstName">Prénom</label>
				<div class="controls">
				  <input type="text" name="inputFirstName" placeholder="Prénom">
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputBirthday">Date d'anniversaire</label>
				<div class="controls">
					<div class="input-append date birthdayPicker">
						<input name="inputBirthday" class="span2" size="160" type="text" value="" readonly>
						<span class="add-on"><i class="icon-th"></i></span>
					</div>
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputEmail">Email</label>
				<div class="controls">
				  <div class="input-append">
					<span class="add-on">@</span>
				  	<input type="text" name="inputEmail" placeholder="Email" class="input-medium">
				  </div>
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputTel">Téléphone</label>
				<div class="controls">
				  <div class="input-append">
					<span class="add-on"><i class="icon-phone"></i> </span>
				  	<input type="text" name="inputTel" placeholder="Numéro de téléphone" class="input-medium">
				  </div>
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputAdresse">Adresse</label>
				<div class="controls">
				  <input type="text" name="inputAdresse" placeholder="N°, Voie, ...">
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputCity">Ville</label>
				<div class="controls">
				  <input type="text" name="inputCP" placeholder="CP" class="input-mini">
				  <input type="text" name="inputCity" placeholder="Ville" class="input-large">
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputProfil">Profil</label>
				<div class="controls">
					<input type="radio" name="inputProfil" value="Chef"> Chef d'unité
					<input type="radio" name="inputProfil" value="Assistant" checked> Assistant
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputFormation">Formation</label>
				<div class="controls">
					<select name="inputFormation">
						{% for formation in formations %}
						<option value="{{formation.lvl}}" {% if formation.lvl == 0 %} selected {% endif %}>
							{{formation.name}}
						</option>>
						{% endfor %}
					</select>
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputCommentaire">Commentaire</label>
				<div class="controls">
					<textarea name="inputCommentaire" rows="10" class="popupTextarea"></textarea>
				</div>
			  </div>
		</form>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Fermer</button>
    <button class="btn btn-primary" onClick="$('#newChefForm').submit()">Ajouter le chef</button>
  </div>
</div>
<div id="updateUserModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="Saisir un chef" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Modifier un chef</h3>
  </div>
  <div class="modal-body">
		  <form class="form-horizontal" action="{{path('maitrise_update')}}" id="updateUserForm" method="POST">
			  <div class="control-group">
				<label class="control-label" for="inputName">Nom</label>
				<div class="controls">
				  <input type="text" name="inputName" placeholder="Nom complet">
				  <input type="hidden" name="inputId">
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputFirstName">Prénom</label>
				<div class="controls">
				  <input type="text" name="inputFirstName" placeholder="Prénom">
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputBirthday">Date d'anniversaire</label>
				<div class="controls">
					<div class="input-append date birthdayPicker">
						<input name="inputBirthday" class="span2" size="160" type="text" value="" readonly>
						<span class="add-on"><i class="icon-th"></i></span>
					</div>
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputEmail">Email</label>
				<div class="controls">
				  <div class="input-append">
					<span class="add-on">@</span>
				  	<input type="text" name="inputEmail" placeholder="Email" class="input-medium">
				  </div>
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputTel">Téléphone</label>
				<div class="controls">
				  <div class="input-append">
					<span class="add-on"><i class="icon-phone"></i> </span>
				  	<input type="text" name="inputTel" placeholder="Numéro de téléphone" class="input-medium">
				  </div>
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputAdresse">Adresse</label>
				<div class="controls">
				  <input type="text" name="inputAdresse" placeholder="N°, Voie, ...">
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputCity">Ville</label>
				<div class="controls">
				  <input type="text" name="inputCP" placeholder="CP" class="input-mini">
				  <input type="text" name="inputCity" placeholder="Ville" class="input-large">
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputProfil">Profil</label>
				<div class="controls">
					<input type="radio" name="inputProfil" value="Chef"> Chef d'unité
					<input type="radio" name="inputProfil" value="Assistant" checked> Assistant
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputFormation">Formation</label>
				<div class="controls">
					<select name="inputFormation">
						{% for formation in formations %}
						<option value="{{formation.lvl}}" {% if formation.lvl == 0 %} selected {% endif %}>
							{{formation.name}}
						</option>>
						{% endfor %}
					</select>
				</div>
			  </div>
			  <div class="control-group">
				<label class="control-label" for="inputCommentaire">Commentaire</label>
				<div class="controls">
					<textarea name="inputCommentaire" rows="10" class="popupTextarea"></textarea>
				</div>
			  </div>
		</form>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Fermer</button>
    <button class="btn btn-primary" onClick="$('#updateUserForm').submit()">Modifier le chef</button>
  </div>
</div>
{% endblock %}
